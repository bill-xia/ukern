KERNEL_OBJS := kernel/main.o \
	kernel/mem.o \
	kernel/ukernio.o \
	kernel/init.o \
	kernel/intr.o \
	kernel/proc.o \

KERNEL_HDRS := kernel/init.h \
	kernel/intr.h \
	kernel/mem.h \
	kernel/proc.h \
	kernel/ukernio.h \

KERNEL_BINS := user/divzero

KERNEL_INC := include

kernel/kernel: $(KERNEL_OBJS) $(KERNEL_BINS) kernel/entry kernel/intr_entry
	ld -T kernel/kernel.ld $^ -b binary $(KERNEL_BINS) -o kernel/kernel

kernel/entry: kernel/entry.S
	$(AS) $< -f elf64 -o $@

kernel/intr_entry: kernel/intr_entry.S
	as $< -o $@

kernel/%.o: kernel/%.c $(KERNEL_HDRS)
	$(CC) $(CFLAGS) -I $(KERNEL_INC) $< -c -o $@